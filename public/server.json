{
  "status": "success",
  "message": {
    "elements": [
      {
        "type": "layout",
        "id": "layoutqurefs",
        "elements": [
          {
            "type": "panel",
            "id": "gridqudoc",
            "elements": [
              {
                "type": "tabs",
                "id": "tabsqurefs",
                "elements": [
                  {
                    "type": "tab",
                    "id": "tabqurefstbl1",
                    "elements": [
                      {
                        "type": "layout",
                        "id": "layoutqudoc",
                        "elements": [
                          {
                            "type": "panel",
                            "elements": [
                              {
                                "type": "grid",
                                "id": "gridqudoc",
                                "properties": {
                                  "header": "testTable",
                                  "pagination": false,
                                  "hierachy": false,
                                  "limit": 2,
                                  "path": "popup.json",
                                  "name": "qu",
                                  "object": "doc"
                                },
                                "elements": [
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "ID",
                                      "caption": "ID",
                                      "hidden": true,
                                      "sortable": true
                                    }
                                  },
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "name",
                                      "caption": "ФИО",
                                      "hidden": false,
                                      "sortable": true
                                    }
                                  },
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "subject",
                                      "caption": "Предмет",
                                      "hidden": false,
                                      "sortable": true,
                                      "type": "reference"
                                    }
                                  },
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "mark",
                                      "caption": "Оценка",
                                      "hidden": false,
                                      "sortable": true
                                    }
                                  },
                                  {
                                    "type": "toolbar",
                                    "elements": [
                                      {
                                        "type": "toolbarItem",
                                        "events": {
                                          "onClick": "addRecord"
                                        },
                                        "properties": {
                                          "caption": "Добавить",
                                          "icon": "fa fa-plus",
                                          "more": false,
                                          "id": "add"
                                        }
                                      },
                                      {
                                        "type": "toolbarItem",
                                        "events": {
                                          "onClick": "editRecord"
                                        },
                                        "properties": {
                                          "caption": "Изменить",
                                          "icon": "fa fa-pencil",
                                          "more": true,
                                          "id": "edit"
                                        }
                                      }
                                    ]
                                  }
                                ],
                                "events": {
                                }
                              }
                            ],
                            "properties": {
                              "position": "main",
                              "width": "50%"
                            }
                          },
                          {
                            "type": "panel",
                            "elements": [
                              {
                                "type": "form",
                                "id": "form2",
                                "properties": {
                                },
                                "elements": [
                                  {
                                    "type": "field",
                                    "id": "field1",
                                    "properties": {
                                      "type": "checkbox",
                                      "label": "Level",
                                      "multiline": false,
                                      "required": true,
                                      "hidden": false,
                                      "enabled": true
                                    },
                                    "elements": [],
                                    "events": {
                                      "changeValue": "onField1ChangeValue"
                                    }
                                  },
                                  {
                                    "type": "dropList",
                                    "id": "field2",
                                    "properties": {
                                      "type": "reference",
                                      "label": "Class",
                                      "required": true,
                                      "hidden": false
                                    },
                                    "elements": [
                                      {
                                        "type": "button",
                                        "id": "field1-edit",
                                        "properties": {
                                          "caption": "edit",
                                          "style": "btn btn-success"
                                        },
                                        "events": {
                                          "click": "onField1EditClick"
                                        }
                                      }
                                    ],
                                    "events": {
                                      "changeValue": "onClassChangeValue"
                                    }
                                  },
                                  {
                                    "type": "dropList",
                                    "id": "field3",
                                    "properties": {
                                      "type": "reference",
                                      "label": "Weapon",
                                      "required": true,
                                      "hidden": false
                                    }
                                  },
                                  {
                                    "type": "button",
                                    "id": "save-btn",
                                    "properties": {
                                      "caption": "Save",
                                      "style": "btn btn-info"
                                    },
                                    "events": {
                                      "click": "onSaveBtnClick"
                                    }
                                  },
                                  {
                                    "type": "button",
                                    "id": "cancel-btn",
                                    "properties": {
                                      "caption": "Cancel",
                                      "style": "btn btn-danger"
                                    }
                                  }
                                ],
                                "events": {
                                  "rendered": "onFormRendered"
                                }
                              }
                            ],
                            "properties": {
                              "position": "left",
                              "width": "50%"
                            }
                          }
                        ]
                      }
                    ],
                    "properties": {
                      "header": "Tab1"
                    }
                  },
                  {
                    "type": "tab",
                    "id": "tabqurefstbl2",
                    "elements": [
                      {
                        "type": "layout",
                        "id": "layoutqudoc2",
                        "elements": [
                          {
                            "type": "panel",
                            "elements": [
                              {
                                "type": "grid",
                                "id": "gridqudoc2",
                                "properties": {
                                  "header": "testTable",
                                  "pagination": false,
                                  "hierachy": false,
                                  "limit": 2,
                                  "path": "popup.json",
                                  "name": "qu",
                                  "object": "doc"
                                },
                                "elements": [
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "ID",
                                      "caption": "ID",
                                      "hidden": true,
                                      "sortable": true
                                    }
                                  },
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "name",
                                      "caption": "ФИО",
                                      "hidden": false,
                                      "sortable": true
                                    }
                                  },
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "subject",
                                      "caption": "Предмет",
                                      "hidden": false,
                                      "sortable": true,
                                      "type": "reference"
                                    }
                                  },
                                  {
                                    "type": "column",
                                    "properties": {
                                      "field": "mark",
                                      "caption": "Оценка",
                                      "hidden": false,
                                      "sortable": true
                                    }
                                  },
                                  {
                                    "type": "toolbar",
                                    "elements": [
                                      {
                                        "type": "toolbarItem",
                                        "events": {
                                          "onClick": "addRecord"
                                        },
                                        "properties": {
                                          "caption": "Добавить",
                                          "icon": "fa fa-plus",
                                          "more": false,
                                          "id": "add"
                                        }
                                      },
                                      {
                                        "type": "toolbarItem",
                                        "events": {
                                          "onClick": "editRecord"
                                        },
                                        "properties": {
                                          "caption": "Изменить",
                                          "icon": "fa fa-pencil",
                                          "more": true,
                                          "id": "edit"
                                        }
                                      }
                                    ]
                                  }
                                ],
                                "events": {
                                }
                              }
                            ],
                            "properties": {
                              "position": "main",
                              "width": "50%"
                            }
                          },
                          {
                            "type": "panel",
                            "elements": [
                              {
                                "type": "form",
                                "id": "form2",
                                "properties": {
                                },
                                "elements": [
                                  {
                                    "type": "field",
                                    "id": "field1",
                                    "properties": {
                                      "type": "checkbox",
                                      "label": "Level",
                                      "multiline": false,
                                      "required": true,
                                      "hidden": false,
                                      "enabled": true
                                    },
                                    "elements": [],
                                    "events": {
                                      "changeValue": "onField1ChangeValue"
                                    }
                                  },
                                  {
                                    "type": "dropList",
                                    "id": "field2",
                                    "properties": {
                                      "type": "reference",
                                      "label": "Class",
                                      "required": true,
                                      "hidden": false
                                    },
                                    "elements": [
                                      {
                                        "type": "button",
                                        "id": "field1-edit",
                                        "properties": {
                                          "caption": "edit",
                                          "style": "btn btn-success"
                                        },
                                        "events": {
                                          "click": "onField1EditClick"
                                        }
                                      }
                                    ],
                                    "events": {
                                      "changeValue": "onClassChangeValue"
                                    }
                                  },
                                  {
                                    "type": "dropList",
                                    "id": "field3",
                                    "properties": {
                                      "type": "reference",
                                      "label": "Weapon",
                                      "required": true,
                                      "hidden": false
                                    }
                                  },
                                  {
                                    "type": "button",
                                    "id": "save-btn",
                                    "properties": {
                                      "caption": "Save",
                                      "style": "btn btn-info"
                                    },
                                    "events": {
                                      "click": "onSaveBtnClick"
                                    }
                                  },
                                  {
                                    "type": "button",
                                    "id": "cancel-btn",
                                    "properties": {
                                      "caption": "Cancel",
                                      "style": "btn btn-danger"
                                    }
                                  }
                                ],
                                "events": {
                                  "rendered": "onFormRendered"
                                }
                              }
                            ],
                            "properties": {
                              "position": "left",
                              "width": "50%"
                            }
                          }
                        ]
                      }
                    ],
                    "properties": {
                      "header": "Tab2"
                    },
                    "events": {
                      "beforeShow": "beforeShow",
                      "afterShow": "beforeShow"
                    }
                  }
                ]
              }
            ],
            "properties": {
              "position": "main",
              "width": "50%"
            }
          }
        ]
      }
    ],
    "code": {
      "makeSearch": "function f(event){console.log(event)}",
      "addRecord": "function main(el) {var func = 'getAddForm';var obj = el.getProperties().object;var name = el.getProperties().name;var url = twoBe.getDefaultParams().url;twoBe.createRequest().addUrl(url).addParam('obj', obj).addParam('name', name).addBefore(function() {el.lock('Идет загрузка..');}).addSuccess(function(data) {twoBe.buildView(data, obj + name + func);el.unlock();}).addError(function(msg) {twoBe.showMessage(0, msg);el.unlock();}).addCacheKey(obj + name + func).send();}",
      "editRecord": "function f(event){w2alert(event.recid); console.log(event,this)}",
      "onSaveBtnClick": "function func(btn){ btn.parent.getData() }",
      "beforeShow": "function f(tab){console.log(tab)}"
    },
    "content": [
      {
        "forId": "gridqudoc",
        "records": [
          {
            "ID": "1-1",
            "name": "Иванов Иван",
            "subject": [
              "1"
            ],
            "mark": 5
          },
          {
            "ID": "1-2",
            "name": "Петров Петр",
            "subject": [
              "1"
            ],
            "mark": 4
          },
          {
            "ID": "1-3",
            "name": "Васильев Василий",
            "subject": [
              "4"
            ],
            "mark": 5
          },
          {
            "ID": "1-4",
            "name": "Тестоввый Тест",
            "subject": [
              "5"
            ],
            "mark": 3
          },
          {
            "ID": "5",
            "name": "Пробная Проба",
            "subject": [
              "2"
            ],
            "mark": 2
          },
          {
            "ID": "1-6",
            "name": "Пробная Проба6",
            "subject": [
              "1"
            ],
            "mark": 2
          },
          {
            "ID": "1-7",
            "name": "Пробная Проба7",
            "subject": [
              "4"
            ],
            "mark": 2
          },
          {
            "ID": "1-8",
            "name": "Пробная Проба8",
            "subject": [
              "3"
            ],
            "mark": 5
          }
        ],
        "fk": {
          "subject": {
            "1": "Физкультура",
            "2": "Русский язык",
            "3": "Алгебра",
            "4": "Геометрия",
            "5": "Физика"
          }
        }
      },
      {
        "forId": "form2",
        "records": [
          {
            "field1": true,
            "field2": [
              "1",
              "3"
            ]
          }
        ],
        "fk": {
          "field2": {
            "1": "Гарри",
            "2": "Рон",
            "3": "Гермиона"
          },
          "field3": {
            "1": "Трансфигурация",
            "2": "Зельеварение",
            "3": "Защита от темных искусств"
          }
        }
      }
    ]
  }
}

